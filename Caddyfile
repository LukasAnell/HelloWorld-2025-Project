resumereviewer.lukasanell.org {
    tls lukasmanell@gmail.com
    encode gzip zstd

    # Proxy API calls to the backend Flask service
    @api path /analyze /health
    reverse_proxy @api backend:5001

    # Optional: expose Ollama API at /ollama/* (handy for debugging)
    handle_path /ollama* {
        reverse_proxy ollama:11434
    }

    # Serve the frontend (index.html + assets) from ./src mounted at /srv
    handle {
        root * /srv
        try_files {path} /index.html
        file_server
        header {
            Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
            X-Content-Type-Options "nosniff"
            X-Frame-Options "DENY"
            Referrer-Policy "no-referrer-when-downgrade"
            Permissions-Policy "geolocation=(), microphone=()"
        }
    }

    log {
        output file /data/access.log
    }
}
